<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>VS Wordle — Competitive Mode</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="themes.css">
</head>
<body>

<script>
  /* Required by your JS */
  const $ = id => document.getElementById(id);
</script>

<div id="appContainer">

  <h1 class="title">VS WORDLE</h1>
  <div id="turnOverlay" class="turn-overlay"></div>

  <div id="turnPopup" class="turn-popup"></div>
  <div id="toast" class="toast"></div>

  <!-- ========== LOBBY ========== -->
  <div id="lobby" class="screen active screen-lobby">
    <h2 class="screen-title">Online Lobby</h2>

    <button id="createRoomBtn" class="primary-btn">Create Room</button>

    <div class="join-block">
      <input id="joinRoomInput" type="text" maxlength="8" placeholder="Room Code">
      <button id="joinRoomBtn" class="primary-btn small">Join</button>
    </div>

    <div id="roomInfo" class="panel" style="display:none;">
      <p><b>Room:</b> <span id="roomCodeLabel" class="room-code"></span></p>
      <div class="panel-section">
        <label><b>Powers:</b>
          <input id="powerCountInput" type="number" min="1" max="10" value="2" class="short-input">
        </label>
        <button id="applyPowerCountBtn" class="primary-btn small">Apply</button>
      </div>
      <p><b>You are:</b> <span id="lobbyRoleLabel">-</span></p>
       <label class="color-picker-row">
          <input type="checkbox" id="useCustomColor">
          <span>Use custom accent color</span>
        </label>
      
        <label class="color-picker-row">
          <span>Accent color</span>
          <input type="color" id="playerColorPicker" disabled>
        </label>
      <button id="switchRolesBtn" class="secondary-btn">Switch Roles</button>
      <button id="readyBtn" class="primary-btn">I'm Ready</button>
    </div>
    <p id="lobbyStatus" class="status"></p>
  </div>

  <!-- ========== MENU ========== -->
  <div id="menu" class="screen">
    <h2 class="screen-title">Game Menu</h2>

    <div class="panel">
      <p><b>Room:</b> <span id="menuRoomCode"></span></p>
      <p><b>You are:</b> <span id="menuPlayerRole"></span></p>     
      <div id="roundSummary" class="summary-box"></div>
    </div>

    <button id="newMatchBtn" class="primary-btn">New Match</button>
  </div>

  <!-- ========== SETTER ========== -->
  <div id="setterScreen" class="screen theme-setter">
     <!-- HEADER -->
          <div class="setter-header">
        <div class="role-title">
          <h2 class="screen-title">Setter</h2>
          <span class="room-code header-room-code"></span>
        </div>
      
        <div class="setter-remaining">
          <span id="remainingWordsSetter">-</span> remaining
        <button
              id="toggleConstraintsBtn"
              class="constraint-toggle-btn"
              title="Toggle constraints"
            >
              ⧉
            </button></div>
      </div>

     <!-- HISTORY TOP -->    
<div class="play-area setter-play">
   <!-- LEFT: powers -->
  <div class="play-row">
        <div class="play-col powers-col">
          <div id="setterPowerContainer"
               class="power-container laser-scope play-col powers-col"></div>
          <button class="keep-btn mobile-keep" id="submitSetterSameBtnMobile" hidden>
        KEEP OLD
          </button>
        </div>
<!-- CENTER: history + drafts -->
    <div class="play-col center-col">
      <div id="constraintRowSetter" class="history-row constraint-row"></div>
      <div id="setterGuesserSubmitted" class="history-tiles history-scroll"></div>
     <div class="draft-row-wrap">
  <div class="draft-stack">
    <div id="draftSetter" class="history-tiles draft-layer"></div>

    <button id="submitSetterSameBtn" class="keep-btn" hidden>KEEP OLD</button>
  </div>
</div>

    </div>
    <div class="side-col"></div>
  </div>
  <!-- KEYBOARD -->
  <div id="keyboardSetter" class="keyboard"></div>
</div>

    <!-- INPUT -->
      
        <div class="guess-input-area" hidden><input id="newSecretInput" class="letter-input" hidden><div class="guess-btn-row" hidden>
          <div class="decision-row" hidden> <button id="submitSetterNewBtn" class="primary-btn small" hidden>New</button>
          </div></div></div>
    <!-- POWERS -->
   
<div id="setterPreview" class="preview-box" style="display:none;"></div>

    <!-- INFO PANEL AT BOTTOM -->
    <div id="turnIndicatorSetter" class="turn-indicator"></div>
    <div id="setterSecretArea" hidden></div>
    <!-- Assassin Modal -->
    <div id="assassinModal" class="modal">
      <div class="modal-content">
        <h3>Assassin Word</h3>
        <input id="assassinInput" maxlength="5" autocomplete="off">
        <button id="assassinSubmitBtn">Set</button>
        <button id="assassinCancelBtn">Cancel</button>
      </div>
    </div>
  </div>
  <!-- Force Guesser Modal -->
  <div id="forceGuessModal" class="modal">
  <div class="modal-content">
    <h3>Force Guess</h3>
    <p id="forceGuessPrompt"></p>
    <div class="decision-row">
      <button id="fgContains"></button>
      <button id="fgStarts"></button>
      <button id="fgEnds"></button>
      <button id="fgDouble">Double Letter</button>
    </div>
  </div>
</div>

  <!-- ========== GUESSER ========== -->

  <div id="guesserScreen" class="screen theme-guesser">
  <!-- HEADER -->
        <div class="guesser-header">
      <div class="role-title">
        <h2 class="screen-title">Guesser</h2>
        <span class="room-code header-room-code"></span>
      </div>
    
      <div class="guesser-remaining">
        <span id="remainingWordsGuesser" hidden></span>
      <button
  class="constraint-toggle-btn"
  title="Toggle constraints"
>
  ⧉
</button>
</div>
    </div>

      <!-- HISTORY TOP -->
    <div class="play-area guesser-play">

  <div class="play-row">
    <div id="guesserPowerContainer"
         class="power-container laser-scope play-col powers-col"></div>

    <div class="play-col center-col">
      <div id="constraintRowGuesser" class="history-row constraint-row"></div>
      <div id="historyGuesser" class="history-tiles history-scroll"></div>
      <div id="draftGuesser" class="history-tiles draft-layer"></div>
    </div>

    <div class="play-col side-col"></div>
  </div>
  <div id="guesserForcedGuessBadge" class="forced-guess-badge" hidden></div>
  <div id="keyboardGuesser" class="keyboard"></div>
</div>

    <div id="turnIndicatorGuesser" class="turn-indicator"></div>
    <!-- Hidden legacy elements (required by JS) -->
 <div class="guesser-legacyxx">
 <p hidden> <span id="knownPatternGuesser"></span></p>
  <p hidden><span id="mustContainGuesser"></span></p>
</div>
  </div>

</div>


<!-- ========== JS (unchanged) ========== -->
<script src="/socket.io/socket.io.js"></script>

<script src="/game-engine/scoring.js"></script>
<script src="/game-engine/history.js"></script>
<script src="/game-engine/preview.js"></script>

<script src="network/socketClient.js"></script>

<script src="ui/constraints.js"></script>
<script src="ui/draftrow.js"></script>
<script src="ui/keyboard.js"></script>
<script src="ui/history.js"></script>

<script src="powerEngine/powerEngine.js"></script>
<script src="powerRules.js"></script>

  
<script src="client/power-functions.js"></script>
<script src="client/remaining-words.js"></script>

<script src="powerEngine/powers/hideTile.js"></script>
<script src="powerEngine/powers/confuseColors.js"></script>
<script src="powerEngine/powers/countOnly.js"></script>
<script src="powerEngine/powers/blindGuess.js"></script>
<script src="powerEngine/powers/forceGuess.js"></script>
<script src="powerEngine/powers/revealGreen.js"></script>
<script src="powerEngine/powers/freezeSecret.js"></script>
<script src="powerEngine/powers/suggestGuess.js"></script>
<script src="powerEngine/powers/suggestSecret.js"></script>
<script src="powerEngine/powers/forceTimer.js"></script>
<script src="powerEngine/powers/revealHistory.js"></script>
<script src="powerEngine/powers/blindSpot.js"></script>
<script src="powerEngine/powers/stealthGuess.js"></script>
<script src="powerEngine/powers/magicMode.js"></script>
<script src="powerEngine/powers/vowelRefresh.js"></script>
<script src="powerEngine/powers/revealLetter.js"></script>
<script src="powerEngine/powers/assassinWord.js"></script>
<script src="client.js"></script>  
<script src="client/socket-events.js"></script>
  <script>
  const syncHeaderRoomCodes = () => {
    const src = document.getElementById("roomCodeLabel");
    if (!src) return;

    document
      .querySelectorAll(".header-room-code")
      .forEach(el => el.textContent = src.textContent);
  };

  const observer = new MutationObserver(syncHeaderRoomCodes);
  const src = document.getElementById("roomCodeLabel");

  if (src) {
    observer.observe(src, { childList: true });
    syncHeaderRoomCodes();
  }
</script>
</body>
</html>
